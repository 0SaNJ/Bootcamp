-------My Journey Through Bootcamp

Who am I?
=========

Hi everyone my name is Jay, Jay Princeton Sanmohadi. I am from Suriname, born and raised. I am currently 17 years of age. I am currently in my 2nd year of High School. VOS Welgedacht C class V504.

My hobbies are soccer and coding and a lil bit of games. I was always interested in the I.C.T. world and wanted to become something in that world. And last year in the month of September I stumbled upon a program called the inno-starter sponsored by Tullow-Oil and run ( managed ) by the lovely Miss Julie Sundar.

So I conveniently decided to sign up for I found it very helpful in my career into becoming a coder. And within a few months I managed to graduate. While I was in the inno-starter I also participated in the Hacko-topia where I did not win but I managed to impress some of the judges. And a few days later Miss Julie asked me if I would like to join another program of hers called Codettes Bootcamp where I would study various I.T. related things.

And now won't you join me as I embark on this journey of the Codettes Bootcamp on a day to day basis.

Week 1 
=======

Day 1 ( online )
----------------

We start the codettes bootcamp journey by learning markdown and making our documents.

### Setup documenting environment:

1.  First we download a markdown viewer to make changes to our documentation (<https://www.fosslinux.com/69203/install-notepad-on-ubuntu.htm> notepad++ for ubuntu )

2.  First off you want to make a git account ( <https://github.com/> )

3.  ![](https://lh4.googleusercontent.com/0LkWKvnTgCOSnWbFC8_Li21sSOYKC8ljWzA5ZjD5PrzNIdJQuTO90QTBzFMXCDx8Th9-wj0wrwLOWKopEGEUxHxpOdAd3KYAC5pPwzchHhkafUJ6CNiOlky-f3xYuD9TrX-1sEhmokKbq3-D4BTzu5c)![](https://lh5.googleusercontent.com/jIgXBftxLbOOAQnVD8QQKmFhmcZC6j2L4MzDbNuez6WlEhakU9SudUgFyqwyFPL4-goP1rV7NR1toZ8oh4eFJXJgLRwNibnno6IgpFK3uLgnIxMltjVe9RdKE1wz6FFh17yEAz9WdcxFIPBQqH3QVec)

4.  Download GitHub desktop on ubuntu (<https://gist.github.com/berkorbay/6feda478a00b0432d13f1fc0a50467f1>)

5.  Clone your repository in your GitHub Desktop![](https://lh5.googleusercontent.com/pGn-zKgor1ynG0Cz9CU0nud1OsQxkyL6NCxCpbbQ4wWfAE8G_ZN7khfQyo5rL7vPAdVot_7KLM_EV-HQ8LcEDpkA5gMkZ4pjiZ9i-v107ka43x_itmZ3xBEhmSAzo7spcw8MFw2P2LzDY3WwKXhzcBc) →![](https://lh6.googleusercontent.com/WSV0z0NalvHv4haTaKLFPz4PlKPbFSp4WRNg3wAO5TxHs3eZuyIQp1aeHvrBVUlVOSb0BV7Q_yDcXVbbfXYnlBZEfFzi8qsdaxuYKVgypt0TM_z1ZGcgo2PeHSfc_ZLpBpFrINk9BxRJXUD1c-OeI_0) →![](https://lh5.googleusercontent.com/a3OhwsX61zRQLwaTbmVJuwCgEQftBX6JfzLwGah-fOAysgul5YN4gIkS7oioOpueib1oXuv_11nV5e14WtHxarRGPQkBhkg61MRVWCMr3k6BDbsZp85mewwzu5uT-Ttrsu3htOR7e0NvvcGqZQ4KotQ)

6.  Choose the repository you want to clone ![](https://lh5.googleusercontent.com/LiofYoqZ-lG_MstnzBn3qtyeayxGso-QYhHFOQ6ThyiaacjXMQG2txmAxugVJnQUbkBknY9n1iLcrD0ewTqAEpX-W52W4CrtLTrZXTvabeO21_qwG6D-KbsFCohoFfxyaI2t-2avAgOMSFjEznppSlk)

7.  Then you will get a file named "GitHub" in your documents 

8.  Then download the clone repository and put the files in your GitHub document. (<https://drive.google.com/drive/folders/1rEbBA5UYhnrQrHGsEiU3D2dWEZyIuBi2?usp=sharing> )

9.  Then you can push your files via GitHub Desktop 

10. Now you will need to get a link to see your documentation![](https://lh3.googleusercontent.com/FkExDj40ysaK9Kcajt5vKg0PR0vkLtbCg1OxSZMUPsFoaoiKM2YeJN2vxkfDG3c_zSahcmp3Fz9lQ78HMLma8f8ViGpJNy6c_HCc1jrAuXdejzdmK_FqrxV7jEJM6_k4Sclyh0wU9p0Hfb84qx4-Ohg)

11. We can make changes online and offline for offline changes we will need markdown (<https://www.markdownguide.org/cheat-sheet/> a cheat sheet ). It is also possible to just do it on google docs and convert it to markdown (<https://euangoddard.github.io/clipboard2markdown/> docs to markdown converter ) we can also download an extension for notepad++ to view our markdown before we upload it ( does not work on ubuntu )

12. If we do it online we need to work in the index file and use markdown language. And if we are done we need to pull it offline via github desktop. 

Week 2 
=======

Day 2 ( online )
----------------

### Setup esp32 environment:

1.  Download Arduino IDE version 1.8.x (<https://www.arduino.cc/en/software/OldSoftwareReleases> )

2.  Setup your esp32 in the Arduino IDE ![](https://lh3.googleusercontent.com/pMwrfDSxzmUbZnXnzNILT0UzzotFXwdtD6liWArLL_iZblfpqq5rWJDkFQn3-mNYkxjfwteiDKw9uvIDpDM1ZatCvX7GjL8CIZc3vD1lO99sxRlsimSZszGSCwEhaw3m1CNgqjeVdGW6EI-urcz8kjA)Paste <https://raw.githubusercontent.com/espressif/arduino-esp32/gh-pages/package_esp32_dev_index.json> in your additional board manager in the preferences of your IDE.

3.  Download the esp32 boards in your boards manager![](https://lh5.googleusercontent.com/zosrxOl5fu-oj7RYbGG-jSnp_8rooRsYzOgKYDrTHAVu2KyHMspSm689lehDrUFjBYsPP1RrIC3oTO5-o--AA2PSOPNAZBSukMw0CafOhpLrjmHek5f-n-C6WhumNlZWhnWmRrPS-J1b7jN4XWt-Kic)![](https://lh5.googleusercontent.com/QI2rR6oD_dSI-3taBId2iDG6mOJwpF8-GQUnJq5iov3uMTUEWkdplIFbm4ADhzNoCX9V49DsIHRc5KDHV2gs00TnQ46v7pCmGZECpD_lFmo_1Ee1RwjtrEa-Ty0ytmZAI1u3l20bd1lDFGKF3tUzZ6w)

4.  Select your board ![](https://lh3.googleusercontent.com/AUg52fn17drNGcQmMpFjCARHnIQOVbWCw7pF0e5oEAEMEK3F7ohUlXr7KxvmbJd7jAJ5blvw-CazkmKqKA1wntRJhyatbj21zkp2_ZTc9apWdejtUfwF8lg6cPm_ig5-WocjVk3mnDakU1udxcdt-3Y)

### First Code:

1.  Download the code and follow the instructions <https://randomnerdtutorials.com/install-esp32-filesystem-uploader-arduino-ide/>  ![](https://lh5.googleusercontent.com/NypjeXmcE8C0keadFNaJILEwh56BzdvmU2IpbFVFoo70wXoHRP1DZKQ-iq2S7YCJ_z4wY_spMRSy1JOcwGm-yWqgjbjR-pZmZzHkAnj2BZCzqSI28256OUryj0hQStRxeex8UP8t1ZdTBQFeUtfuOnk)

2.  Make a folder called code like this ![](https://lh4.googleusercontent.com/Fj51PCxilui6RbF0DsW4QI_t2ND8x04ewRWY6iLrxNCb0H1ekXLOdGlKKHn6TLKQVcAxGKAVl-WGnJUZNyLl2IDLkZ0Z46M0rg1SnLGveONklClINiQrpoLxgZ2zYdd5hVkzAQ-MjbeLXa3XNu4ThcA)

3.  Install spiffs ( Make folder called tools and install spiffs there ) like here ![](https://lh3.googleusercontent.com/P-Q6gObApbLZgz4bsgY4foQlovg99cl9v_IVd03_TX9ZK4_OBd5CMlWArxnKGxGwnaBzy5H0tgXHx4iGLvUOZ5i1nw529LMF5UcWijNq4jOk6UsczU9Hm5wPlrZbW5ZBRF3MX5Z0QIjrxZA34QuvLkw)If everything is done correctly you should see this ESP32 Sketch Data Upload![](https://lh5.googleusercontent.com/3ayzd659ikAmzwh2GNgGG4MUuHRSILwjmTBB_pVPcqRqdQ56d1ArdO0zmQu8c_TCTmFbWlXwJ81aUz9IIwaI0BKkzsAwaIxNdpoq-IbNghApTVlEmPQgtDoXvw4URl2iarECK4eN8EgFiKpUscioSVg)

4.  Open the .ino file and change your wifi credentials ![](https://lh4.googleusercontent.com/iMx_MUq_Hr6wWy7wqlxyVEYMLCW6JL4i69Do0ZvCWJsfZq1ZmcE-93uUd3B4LDIhYUVm5MAO281mKUbI8eBxnIbAjRsA7ClqGFlHJmk9QFeng3CQQQlYZXaGKbR3EB2WmiAS8Tvy4QMDY02MqLHknBI)

5.  C++ Code 

|

/*********\
  Rui Santos\
  Complete project details at https://randomnerdtutorials.com\
*********/

// Import required libraries\
#include "WiFi.h"\
#include "ESPAsyncWebServer.h"\
#include "SPIFFS.h"

// Replace with your network credentials\
const  char* ssid = "HUAWEI-2.4G-yzad";\
const  char* password = "SkNH972g";

// Set LED GPIO\
const  int ledPin = 2;\
// Stores LED state\
String ledState;

// Create AsyncWebServer object on port 80\
AsyncWebServer server(80);

// Replaces placeholder with LED state value\
String processor(const String& var){\
  Serial.println(var);\
 if(var == "STATE"){\
 if(digitalRead(ledPin)){\
ledState = "ON";\
    }\
 else{\
ledState = "OFF";\
    }\
    Serial.print(ledState);\
 return ledState;\
  }\
 return String();\
}

void  setup(){\
 // Serial port for debugging purposes\
  Serial.begin(115200);\
  pinMode(ledPin, OUTPUT);

 // Initialize SPIFFS\
 if(!SPIFFS.begin(true)){\
    Serial.println("An Error has occurred while mounting SPIFFS");\
 return;\
  }

 // Connect to Wi-Fi\
  WiFi.begin(ssid, password);\
 while (WiFi.status() != WL_CONNECTED) {\
    delay(1000);\
    Serial.println("Connecting to WiFi..");\
  }

 // Print ESP32 Local IP Address\
  Serial.println(WiFi.localIP());

 // Route for root / web page\
  server.on("/", HTTP_GET, [](AsyncWebServerRequest *request){\
request->send(SPIFFS, "/index.html", String(), false, processor);\
  });

 // Route to load style.css file\
  server.on("/style.css", HTTP_GET, [](AsyncWebServerRequest *request){\
request->send(SPIFFS, "/style.css", "text/css");\
  });

 // Route to set GPIO to HIGH\
  server.on("/on", HTTP_GET, [](AsyncWebServerRequest *request){\
    digitalWrite(ledPin, HIGH);\
request->send(SPIFFS, "/index.html", String(), false, processor);\
  });

 // Route to set GPIO to LOW\
  server.on("/off", HTTP_GET, [](AsyncWebServerRequest *request){\
    digitalWrite(ledPin, LOW);\
request->send(SPIFFS, "/index.html", String(), false, processor);\
  });

 // Start server\
  server.begin();\
}

void  loop(){

}

 |

( [link to github code ](https://github.com/0SaNJ/codettesbootcamp_2023_code/blob/main/ESP_32_async_webserver_c%2B%2B) )

1.  Upload ESP32 Sketch Data Upload if you did everything right you should see this → ![](https://lh5.googleusercontent.com/sVRcTI4M3ZmlT0WCrHgmxrUMF1gsU6YNcyzTxV4Sw5O_Sm-Q62SWM2OIXKsMMFrTc8KyLhyX2pX1SlSlQ-1r2sSDgzj5o_ES9dv-CMrNeOgHA5w9OnI9kLXLQpVcD7GCikQnoWPv270-vxIucgTvSl8)

2.  The html code

|

<!DOCTYPE html>\
<html>\
<head>\
<title>ESP32 Web Server</title>\
<meta  name="viewport"  content="width=device-width, initial-scale=1">\
<link  rel="icon"  href="data:,">\
<link  rel="stylesheet"  type="text/css"  href="style.css">\
<style>\
html{\
font-family: Helvetica;\
display: inline-block;\
margin: 0px auto;\
text-align: center;\
}\
h1{\
color: #0F3376;\
padding: 2vh;\
}\
p{\
font-size: 1.5rem;\
}\
.button{\
display: inline-block;\
background-color: #008CBA;\
border: none;\
border-radius: 4px;\
color: white;\
padding: 16px  40px;\
text-decoration: none;\
font-size: 30px;\
margin: 2px\
cursor pointer;\
}\
.button2{\
background-color: #f44336;\
}\
</style>\
</head>\
<body>\
<h1>ESP32 Web Server</h1>\
<p>GPIO state: <strong> %STATE%</strong></p>\
<p><a  href="/on"><button  class="button">ON</button></a></p>\
<p><a  href="/off"><button  class="button button2">OFF</button></a></p>\
</body>\
</html>

 |

( [link to github code](https://github.com/0SaNJ/codettesbootcamp_2023_code/blob/main/ESP_32_async_webserver_html) )

1.  Now Upload the code and see if it works if everything is done right you should see this ![](https://lh6.googleusercontent.com/1uHX0opYyqu1ZVeTjeBbXXhbi0tzDy-hdIZ_zsdL0Tv8p9_0s5uMxtWRDzxTspZOS7rNxjaOv8loRJPvZSoQMfCZTOxaEG2c_xjTgtK25v4JtPNQIJAKjxPs_tj-waEVU3kc52W0tDWBwLsdBSKd6X8)and should have a led that can turn on and off via websockets like here![](https://lh6.googleusercontent.com/6qIiUyzbbhLIPfWztPZyREnAYVqSf3-aNdCe7LXKqDk5VMQQCbaKrsW3MXaoiSXZU_Gh8BtX82k7tCl7aqDPFZBqaU7ZbMNJ9FACYMhRRwO5D1ppkfDFW3c-YG2Y5RVnXxp1tFDHooF5PbxzbqURFvA)

2.  The CSS code

|

html {\
 font-family: Helvetica;\
 display: inline-block;\
 margin: 0px auto;\
 text-align: center;\
}\
h1{\
 color: #0F3376;\
 padding: 2vh;\
}\
p{\
 font-size: 1.5rem;\
}\
.button {\
 display: inline-block;\
 background-color: #008CBA;\
 border: none;\
 border-radius: 4px;\
 color: white;\
 padding: 16px  40px;\
 text-decoration: none;\
 font-size: 30px;\
 margin: 2px;\
 cursor: pointer;\
}\
.button2 {\
 background-color: #f44336;\
}

 |

Week 3
======

Day 3 ( online )
----------------

### Multiple sliders code:

1.  First we need to download our libraries  ( <https://github.com/arduino-libraries/Arduino_JSON> )

2.  We make a libraries folder then put or library in there like here![](https://lh3.googleusercontent.com/Y3A99OVmY8fisIRZ6B1cw8K_nmcZ38vThle6cnglI7f8rFCPQz3d0Zc8zwYT0d9E6V0L_9o1DureESV8_K2E8hsvgCYVgp8-f9UNuc7FRR672T7kliHDyLs4Vg3j1G6HF6vTeOX4_LfP-tBEns6za78)

3.  Then we put it in our arduino libraries folder ![](https://lh3.googleusercontent.com/b64IKa6zOBV9kJ3K2fO5o2z585-X-3W2nN3bGPPUmjmCIAe1DwaasAGDNjXuhH9Vu5u2Bmbm_kovEw7zvfg8IUPtlaJeCQGN_vQjoYuSwkGGRx7_P6GRJWhDGy2HWBUsCmNqUMvtHC_stjScJKN1lnw)

4.  Now we download the code and follow the tutorial here ( <https://randomnerdtutorials.com/esp32-web-server-websocket-sliders/> )

5.  The C++ code 

|

/*\
  Rui Santos\
  Complete project details at https://RandomNerdTutorials.com/esp32-web-server-websocket-sliders/

  Permission is hereby granted, free of charge, to any person obtaining a copy\
  of this software and associated documentation files.

  The above copyright notice and this permission notice shall be included in all\
  copies or substantial portions of the Software.\
*/

#include <Arduino.h>\
#include <WiFi.h>\
#include <AsyncTCP.h>\
#include <ESPAsyncWebServer.h>\
#include "SPIFFS.h"\
#include <Arduino_JSON.h>

// Replace with your network credentials\
const  char* ssid = "HUAWEI-2.4G-yzad";\
const  char* password = "SkNH972g";

// Create AsyncWebServer object on port 80\
AsyncWebServer server(80);\
// Create a WebSocket object

AsyncWebSocket ws("/ws");\
// Set LED GPIO\
const  int ledPin1 = 32;\
const  int ledPin2 = 26;\
const  int ledPin3 = 14;\
const  int ledPin4 = 12;\
const  int ledPin5 = 13;

String message = "";\
String sliderValue1 = "0";\
String sliderValue2 = "0";\
String sliderValue3 = "0";\
String sliderValue4 = "0";\
String sliderValue5 = "0";

int dutyCycle1;\
int dutyCycle2;\
int dutyCycle3;\
int dutyCycle4;\
int dutyCycle5;

// setting PWM properties\
const  int freq = 5000;\
const  int ledChannel1 = 0;\
const  int ledChannel2 = 1;\
const  int ledChannel3 = 2;\
const  int ledChannel4 = 3;\
const  int ledChannel5 = 4;

const  int resolution = 8;

//Json Variable to Hold Slider Values\
JSONVar sliderValues;

//Get Slider Values\
String getSliderValues(){\
  sliderValues["sliderValue1"] = String(sliderValue1);\
  sliderValues["sliderValue2"] = String(sliderValue2);\
  sliderValues["sliderValue3"] = String(sliderValue3);\
  sliderValues["sliderValue4"] = String(sliderValue4);\
  sliderValues["sliderValue5"] = String(sliderValue5);

  String jsonString = JSON.stringify(sliderValues);\
 return jsonString;\
}

// Initialize SPIFFS\
void  initFS() {\
 if (!SPIFFS.begin()) {\
    Serial.println("An error has occurred while mounting SPIFFS");\
  }\
 else{\
  Serial.println("SPIFFS mounted successfully");\
  }\
}

// Initialize WiFi\
void  initWiFi() {\
  WiFi.mode(WIFI_STA);\
  WiFi.begin(ssid, password);\
  Serial.print("Connecting to WiFi ..");\
 while (WiFi.status() != WL_CONNECTED) {\
    Serial.print('.');\
    delay(1000);\
  }\
  Serial.println(WiFi.localIP());\
}

void  notifyClients(String sliderValues) {\
  ws.textAll(sliderValues);\
}

void  handleWebSocketMessage(void *arg, uint8_t *data, size_t len) {\
  AwsFrameInfo *info = (AwsFrameInfo*)arg;\
 if (info->final && info->index == 0 && info->len == len && info->opcode == WS_TEXT) {\
data[len] = 0;\
    message = (char*)data;\
 if (message.indexOf("1s") >= 0) {\
      sliderValue1 = message.substring(2);\
dutyCycle1 = map(sliderValue1.toInt(), 0, 100, 0, 255);\
      Serial.println(dutyCycle1);\
      Serial.print(getSliderValues());\
      notifyClients(getSliderValues());\
    }\
 if (message.indexOf("2s") >= 0) {\
      sliderValue2 = message.substring(2);\
dutyCycle2 = map(sliderValue2.toInt(), 0, 100, 0, 255);\
      Serial.println(dutyCycle2);\
      Serial.print(getSliderValues());\
      notifyClients(getSliderValues());\
    }\
 if (message.indexOf("3s") >= 0) {\
      sliderValue3 = message.substring(2);\
dutyCycle3 = map(sliderValue3.toInt(), 0, 100, 0, 255);\
      Serial.println(dutyCycle3);\
      Serial.print(getSliderValues());\
      notifyClients(getSliderValues());\
    }\
 if (message.indexOf("4s") >= 0) {\
      sliderValue4 = message.substring(2);\
dutyCycle4 = map(sliderValue4.toInt(), 0, 100, 0, 255);\
      Serial.println(dutyCycle4);\
      Serial.print(getSliderValues());\
      notifyClients(getSliderValues());\
    }\
 if (message.indexOf("5s") >= 0) {\
      sliderValue5 = message.substring(2);\
dutyCycle5 = map(sliderValue5.toInt(), 0, 100, 0, 255);\
      Serial.println(dutyCycle5);\
      Serial.print(getSliderValues());\
      notifyClients(getSliderValues());\
    }\
 if (strcmp((char*)data, "getValues") == 0) {\
      notifyClients(getSliderValues());\
    }\
  }\
}\
void  onEvent(AsyncWebSocket *server, AsyncWebSocketClient *client, AwsEventType type, void *arg, uint8_t *data, size_t len) {\
 switch (type) {\
 case WS_EVT_CONNECT:\
      Serial.printf("WebSocket client #%u connected from %s\n", client->id(), client->remoteIP().toString().c_str());\
 break;\
 case WS_EVT_DISCONNECT:\
      Serial.printf("WebSocket client #%u disconnected\n", client->id());\
 break;\
 case WS_EVT_DATA:\
      handleWebSocketMessage(arg, data, len);\
 break;\
 case WS_EVT_PONG:\
 case WS_EVT_ERROR:\
 break;\
  }\
}

void  initWebSocket() {\
  ws.onEvent(onEvent);\
  server.addHandler(&ws);\
}

void  setup() {\
  Serial.begin(115200);\
  pinMode(ledPin1, OUTPUT);\
  pinMode(ledPin2, OUTPUT);\
  pinMode(ledPin3, OUTPUT);\
  pinMode(ledPin4, OUTPUT);\
  pinMode(ledPin5, OUTPUT);\
  initFS();\
  initWiFi();

 // configure LED PWM functionalities\
  ledcSetup(ledChannel1, freq, resolution);\
  ledcSetup(ledChannel2, freq, resolution);\
  ledcSetup(ledChannel3, freq, resolution);\
  ledcSetup(ledChannel4, freq, resolution);\
  ledcSetup(ledChannel5, freq, resolution);

 // attach the channel to the GPIO to be controlled\
  ledcAttachPin(ledPin1, ledChannel1);\
  ledcAttachPin(ledPin2, ledChannel2);\
  ledcAttachPin(ledPin3, ledChannel3);\
  ledcAttachPin(ledPin4, ledChannel4);\
  ledcAttachPin(ledPin5, ledChannel5);

  initWebSocket();

 // Web Server Root URL\
  server.on("/", HTTP_GET, [](AsyncWebServerRequest *request){\
request->send(SPIFFS, "/index.html", "text/html");\
  });

  server.serveStatic("/", SPIFFS, "/");

 // Start server\
  server.begin();

}

void  loop() {\
  ledcWrite(ledChannel1, dutyCycle1);\
  ledcWrite(ledChannel2, dutyCycle2);\
  ledcWrite(ledChannel3, dutyCycle3);\
  ledcWrite(ledChannel4, dutyCycle4);\
  ledcWrite(ledChannel5, dutyCycle5);

  ws.cleanupClients();\
}

 |

( [link to github code](https://github.com/0SaNJ/codettesbootcamp_2023_code/blob/main/ESP_32_multiple_sliders_webserver_code) )

1.  We repeat the process from last week and upload the spiff then the code then we should have a working web page with sliders and leds. If done right you should get something like this.

|

<!-- Complete project details: https://randtutorials.com/esp32-web-server-websocket-sliders/ -->

<!DOCTYPE html>\
<html>\
<head>\
<title>ESP IOT DASHBOARD</title>\
<meta  name="viewport"  content="width=device-width, initial-scale=1">\
<link  rel="icon"  type="image/png"  href="favicon.png">\
<link  rel="stylesheet"  type="text/css"  href="style.css">\
</head>\
<body>\
<div  class="topnav">\
<h1>Multiple Sliders</h1>\
</div>\
<div  class="content">\
<div  class="card-grid">\
<div  class="card">\
<p  class="card-title">Fader 1</p>\
<p  class="switch">\
<input  type="range"  onchange="updateSliderPWM(this)"  id="slider1"  min="0"  max="100"  step="1"  value ="0"  class="slider">\
</p>\
<p  class="state">Brightness: <span  id="sliderValue1"></span> &percnt;</p>\
</div>\
<div  class="card">\
<p  class="card-title"> Fader 2</p>\
<p  class="switch">\
<input  type="range"  onchange="updateSliderPWM(this)"  id="slider2"  min="0"  max="100"  step="1"  value ="0"  class="slider">\
</p>\
<p  class="state">Brightness: <span  id="sliderValue2"></span> &percnt;</p>\
</div>\
<div  class="card">\
<p  class="card-title"> Fader 3</p>\
<p  class="switch">\
<input  type="range"  onchange="updateSliderPWM(this)"  id="slider3"  min="0"  max="100"  step="1"  value ="0"  class="slider">\
</p>\
<p  class="state">Brightness: <span  id="sliderValue3"></span> &percnt;</p>\
</div>\
<div  class="card">\
<p  class="card-title"> Fader 4</p>\
<p  class="switch">\
<input  type="range"  onchange="updateSliderPWM(this)"  id="slider4"  min="0"  max="100"  step="1"  value ="0"  class="slider">\
</p>\
<p  class="state">Brightness: <span  id="sliderValue4"></span> &percnt;</p>\
</div>\
<div  class="card">\
<p  class="card-title"> Fader 5</p>\
<p  class="switch">\
<input  type="range"  onchange="updateSliderPWM(this)"  id="slider5"  min="0"  max="100"  step="1"  value ="0"  class="slider">\
</p>\
<p  class="state">Brightness: <span  id="sliderValue5"></span> &percnt;</p>\
</div>\
</div>\
</div>\
<script  src="script.js"></script>\
</body>\
</html>

 |

( [link to github code](https://github.com/0SaNJ/codettesbootcamp_2023_code/blob/main/ESP_32_multiple_sliders_webserver_code_html)  )\
![](https://lh3.googleusercontent.com/HFtckLGtLymxjT-rEF75RskGjkozkONqCYma8YzmxmFHCtQq_qB7xE32sswWP0vmRHCxk1x2lTnWgSuaBxfz0lctgUZwP2k4Zsa3bwy9B9WRjrqnLfxr97bbuhQzM7OUCivwLgNGj74G4KRV42Lu_UA)

1.  We can customize our webpage using css we do that by going into our index.html and configuring there ![](https://lh4.googleusercontent.com/f6Id5zzQrXbHwjmDSne9bN90Egs7y4XC_9UmKnvPsnybHjXzmqhOuNem9wIIjqZT5riZAoJbR-ZCm_FeJOer0gD4ZhgF40OHA7qzdmd4tK1vHzHl_RGehbJhgwG4Qrzao5tzL2dwpqe0mvZmvg0_WkE)

2.  The CSS Code

|

/* Complete project details: https://randomnerdtutorials.com/esp32-web-server-websocket-sliders/ */

html {\
font-family: Arial, Helvetica, sans-serif;\
display: inline-block;\
text-align: center;\
background: rgb(212, 184, 184);\
}\
h1 {\
font-size: 1.8rem;\
color: black;\
}\
p {\
font-size: 1.4rem;\
}\
.topnav {\
overflow: hidden;\
background-color: #374fa0;\
}\
body {\
margin: 0;\
}\
.content {\
padding: 30px;\
}\
.card-grid {\
max-width: 700px;\
margin: 0 auto;\
display: grid;\
grid-gap: 2rem;\
grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));\
}\
.card {\
background-color: rgb(216, 79, 79);\
box-shadow: 2px  2px  12px  1px  rgba(140,140,140,.5);\
}\
.card-title {\
font-size: 1.2rem;\
font-weight: bold;\
color: #034078\
}\
.state {\
font-size: 1.2rem;\
color:#1282A2;\
}\
.slider {\
-webkit-appearance: none;\
margin: 0 auto;\
width: 100%;\
height: 15px;\
border-radius: 10px;\
background: #FFD65C;\
outline: none;\
}\
.slider::-webkit-slider-thumb {\
-webkit-appearance: none;\
appearance: none;\
width: 30px;\
height: 30px;\
border-radius: 50%;\
background: #034078;\
cursor: pointer;\
}\
.slider::-moz-range-thumb {\
width: 30px;\
height: 30px;\
border-radius: 50% ;\
background: #034078;\
cursor: pointer;\
}\
.switch {\
padding-left: 5%;\
padding-right: 5%;\
}

 |

( [link to github code](https://github.com/0SaNJ/codettesbootcamp_2023_code/blob/main/ESP_32_multiple_sliders_webserver_code_css)  )

Week 4 
=======

Day 4 ( online )
----------------

### DHT sensor setup:

1.  First off we have to understand which DHT sensor we have and how we should wire them.

2.  The DHT were using is DHT 11 ![](https://lh3.googleusercontent.com/scvvS0UOlT1vbM6NSBp9vh-aY5wxdLjDJK72-nHdwzWIznSULtUG_06NupW4RfhFY5VzWBee4RDVJhOWCxvB47FpI64qCcVYgb4MZZM1gdIqOhWE6ixQM3rNsXfJ8M9eFNSZEe2J-zE-3yCQnlbt1f0)

3.  How to wire the DHT 11![](https://lh5.googleusercontent.com/kruB0cvjFsrLEugy_bGY7phWubqot2SMzqW2rJA74CJEovYuMk0hUwnI9YbYa4R8whkpheR984bBz4VhiVaTTExcqbhCH-dAGUrBRKpnjsFWdCc3z3b5TpsIGJ-8rFb4dU8mUByDeiVJFRL22nvryCg)

4.  Then we download the required libraries to get the readings from the DHT ![](https://lh5.googleusercontent.com/yfGcsKlNBP3CGieuI0Mk1_-4Sn2MrMkQfsFDOSSLZg0icf3QqA6PD3vv-spXohFuahLikAw729KFmVZye0inuHZPVM-Kwfmkso3X4apLCracEMPdLXl1Ef-nVlS0FlRw4YWnqxayLuEkTJbXs21nllI)![](https://lh6.googleusercontent.com/OT2g77JF-Sqvda5wjpcbME0nbrw_lK31imAl6g1svyIzulB4Upxb6JdfmAw0pXtNMvmjS-Hi41esSS3Wc8CjY_TKyTipih6fXtCGVeFHrcem6yDBpI6FYAlJhmjtsihXDl3pWcdLMgaSg5utnl31jb0)

5.  Now we download the Adafruit Unified Sensor library ![](https://lh5.googleusercontent.com/AxuWQ_hRxqAc7egANDLYgmqAiAxGREpouf0YDeayEwkmnkttuuDOTRhIMlmA-XidvMDGNCI9L6KRn3UniqF_rO1pi4XHjCFcfXe7FrTUshh4-Fo67nFQwhuJWSCDEp3a4Xn5fwueTf8dxsNsSqlYlvU)( <https://randomnerdtutorials.com/esp32-dht11-dht22-temperature-humidity-sensor-arduino-ide/> )

6.  Then we implement the code 

|

// Example testing sketch for various DHT humidity/temperature sensors written by ladyada\
// REQUIRES the following Arduino libraries:\
// - DHT Sensor Library: https://github.com/adafruit/DHT-sensor-library\
// - Adafruit Unified Sensor Lib: https://github.com/adafruit/Adafruit_Sensor

#include "DHT.h"

#define DHTPIN 4     // Digital pin connected to the DHT sensor\
// Feather HUZZAH ESP8266 note: use pins 3, 4, 5, 12, 13 or 14 --\
// Pin 15 can work but DHT must be disconnected during program upload.

// Uncomment whatever type you're using!\
//#define DHTTYPE DHT11   // DHT 11\
#define DHTTYPE DHT22   // DHT 22  (AM2302), AM2321\
//#define DHTTYPE DHT21   // DHT 21 (AM2301)

// Connect pin 1 (on the left) of the sensor to +5V\
// NOTE: If using a board with 3.3V logic like an Arduino Due connect pin 1\
// to 3.3V instead of 5V!\
// Connect pin 2 of the sensor to whatever your DHTPIN is\
// Connect pin 4 (on the right) of the sensor to GROUND\
// Connect a 10K resistor from pin 2 (data) to pin 1 (power) of the sensor

// Initialize DHT sensor.\
// Note that older versions of this library took an optional third parameter to\
// tweak the timings for faster processors.  This parameter is no longer needed\
// as the current DHT reading algorithm adjusts itself to work on faster procs.\
DHT dht(DHTPIN, DHTTYPE);

void  setup() {\
  Serial.begin(9600);\
  Serial.println(F("DHTxx test!"));

  dht.begin();\
}

void  loop() {\
 // Wait a few seconds between measurements.\
  delay(2000);

 // Reading temperature or humidity takes about 250 milliseconds!\
 // Sensor readings may also be up to 2 seconds 'old' (its a very slow sensor)\
 float h = dht.readHumidity();\
 // Read temperature as Celsius (the default)\
 float t = dht.readTemperature();\
 // Read temperature as Fahrenheit (isFahrenheit = true)\
 float f = dht.readTemperature(true);

 // Check if any reads failed and exit early (to try again).\
 if (isnan(h) || isnan(t) || isnan(f)) {\
    Serial.println(F("Failed to read from DHT sensor!"));\
 return;\
  }

 // Compute heat index in Fahrenheit (the default)\
 float hif = dht.computeHeatIndex(f, h);\
 // Compute heat index in Celsius (isFahreheit = false)\
 float hic = dht.computeHeatIndex(t, h, false);

  Serial.print(F("Humidity: "));\
  Serial.print(h);\
  Serial.print(F("%  Temperature: "));\
  Serial.print(t);\
  Serial.print(F("°C "));\
  Serial.print(f);\
  Serial.print(F("°F  Heat index: "));\
  Serial.print(hic);\
  Serial.print(F("°C "));\
  Serial.print(hif);\
  Serial.println(F("°F"));\
}

 |

( [link to github code](https://github.com/0SaNJ/codettesbootcamp_2023_code/blob/main/ESP_32_DHT_C%2B%2B) )

1.  If everything is done right you should get something like this in your serial monitor\
    ![](https://lh4.googleusercontent.com/7BYOl4dOowmfxW3E2Ca-R93ks3wQMKJ_wpRzxYIAN45jZ36EY4r6NrzUsx51pgcx4IymU8XNUJcaaW06rvDDo7V4WWAVrTVRvKapmAKvk4clmiCurar_6uSPV9L9HiL_W6d6hGwGdR9VwF9vDccLz1g)

### DHT sensor with web server:

1.  First off we make a new ino file and import this C++ code ( you can follow this link <https://randomnerdtutorials.com/esp32-dht11-dht22-temperature-humidity-web-server-arduino-ide/> )

2.  The C++ code 

|

/*********\
  Rui Santos\
  Complete project details at https://randomnerdtutorials.com\
*********/

// Import required libraries\
#include "WiFi.h"\
#include "ESPAsyncWebServer.h"\
#include <Adafruit_Sensor.h>\
#include <DHT.h>

// Replace with your network credentials\
const  char* ssid = "REPLACE_WITH_YOUR_SSID";\
const  char* password = "REPLACE_WITH_YOUR_PASSWORD";

#define DHTPIN 27     // Digital pin connected to the DHT sensor

// Uncomment the type of sensor in use:\
//#define DHTTYPE    DHT11     // DHT 11\
#define DHTTYPE    DHT22     // DHT 22 (AM2302)\
//#define DHTTYPE    DHT21     // DHT 21 (AM2301)

DHT dht(DHTPIN, DHTTYPE);

// Create AsyncWebServer object on port 80\
AsyncWebServer server(80);

String readDHTTemperature() {\
 // Sensor readings may also be up to 2 seconds 'old' (its a very slow sensor)\
 // Read temperature as Celsius (the default)\
 float t = dht.readTemperature();\
 // Read temperature as Fahrenheit (isFahrenheit = true)\
 //float t = dht.readTemperature(true);\
 // Check if any reads failed and exit early (to try again).\
 if (isnan(t)) {\
    Serial.println("Failed to read from DHT sensor!");\
 return  "--";\
  }\
 else {\
    Serial.println(t);\
 return String(t);\
  }\
}

String readDHTHumidity() {\
 // Sensor readings may also be up to 2 seconds 'old' (its a very slow sensor)\
 float h = dht.readHumidity();\
 if (isnan(h)) {\
    Serial.println("Failed to read from DHT sensor!");\
 return  "--";\
  }\
 else {\
    Serial.println(h);\
 return String(h);\
  }\
}

const  char index_html[] PROGMEM = R"rawliteral(\
<!DOCTYPE HTML><html>\
<head>\
  <meta name="viewport" content="width=device-width, initial-scale=1">\
  <link rel="stylesheet" href="https://use.fontawesome.com/releases/v5.7.2/css/all.css" integrity="sha384-fnmOCqbTlWIlj8LyTjo7mOUStjsKC4pOpQbqyi7RrhN7udi9RwhKkMHpvLbHG9Sr" crossorigin="anonymous">\
  <style>\
    html {\
    font-family: Arial;\
    display: inline-block;\
margin: 0px auto;\
    text-align: center;\
    }\
h2 { font-size: 3.0rem; }\
p { font-size: 3.0rem; }\
.units { font-size: 1.2rem; }\
    .dht-labels{\
font-size: 1.5rem;\
      vertical-align:middle;\
padding-bottom: 15px;\
    }\
  </style>\
</head>\
<body>\
  <h2>ESP32 DHT Server</h2>\
  <p>\
<i class="fas fa-thermometer-half" style="color:#059e8a;"></i>\
<span class="dht-labels">Temperature</span>\
    <span id="temperature">%TEMPERATURE%</span>\
<sup class="units">&deg;C</sup>\
  </p>\
  <p>\
<i class="fas fa-tint" style="color:#00add6;"></i>\
<span class="dht-labels">Humidity</span>\
    <span id="humidity">%HUMIDITY%</span>\
<sup class="units">&percnt;</sup>\
  </p>\
</body>\
<script>\
setInterval(function ( ) {\
 var xhttp = new XMLHttpRequest();\
  xhttp.onreadystatechange = function() {\
 if (this.readyState == 4 && this.status == 200) {\
      document.getElementById("temperature").innerHTML = this.responseText;\
    }\
  };\
  xhttp.open("GET", "/temperature", true);\
  xhttp.send();\
}, 10000 ) ;

setInterval(function ( ) {\
 var xhttp = new XMLHttpRequest();\
  xhttp.onreadystatechange = function() {\
 if (this.readyState == 4 && this.status == 200) {\
      document.getElementById("humidity").innerHTML = this.responseText;\
    }\
  };\
  xhttp.open("GET", "/humidity", true);\
  xhttp.send();\
}, 10000 ) ;\
</script>\
</html>)rawliteral";

// Replaces placeholder with DHT values\
String processor(const String& var){\
  //Serial.println(var);\
  if(var == "TEMPERATURE"){\
    return readDHTTemperature();\
  }\
  else if(var == "HUMIDITY"){\
    return readDHTHumidity();\
  }\
  return String();\
}

void setup(){\
  // Serial port for debugging purposes\
  Serial.begin(115200);

  dht.begin();

  // Connect to Wi-Fi\
  WiFi.begin(ssid, password);\
  while (WiFi.status() != WL_CONNECTED) {\
    delay(1000);\
    Serial.println("Connecting to WiFi..");\
  }

  // Print ESP32 Local IP Address\
  Serial.println(WiFi.localIP());

  // Route for root / web page\
  server.on("/", HTTP_GET, [](AsyncWebServerRequest *request){\
    request->send_P(200, "text/html", index_html, processor);\
  });\
  server.on("/temperature", HTTP_GET, [](AsyncWebServerRequest *request){\
    request->send_P(200, "text/plain", readDHTTemperature().c_str());\
  });\
  server.on("/humidity", HTTP_GET, [](AsyncWebServerRequest *request){\
    request->send_P(200, "text/plain", readDHTHumidity().c_str());\
  });

  // Start server\
  server.begin();\
}

void loop(){

}

 |

( [link to github code](https://github.com/0SaNJ/codettesbootcamp_2023_code/blob/main/ESP_32_DHT_webserver_C%2B%2B) )

1.  Then we upload spiffs 

2.  Then we should get this on your page if everything is done correctly ![](https://lh3.googleusercontent.com/V3e6hFtBscIettkWoNcdWXAgalAKX_cqP2qptK5hddP0jC9-JoC8ZYUv2r-gQFnvYp6OipUXqsc-M7OgZVOEtn1pH7MpmD_0_jN0H13El06U7V_YIEjds9U_8H2h38hzibC6rb1nhhjup6qq33PJlvk)

Week 5
======

Day 5 ( online )
----------------

### MQTT setup:

1.  First off we download MQTT lens ( <https://chrome.google.com/webstore/detail/mqttlens/hemojaaeigabkbcookmlgmdigohjobjm> )

2.  We need to understand the connection that takes place when sending and parsing data via MQTT, here: ![](https://lh6.googleusercontent.com/iUVTLjmpzKJgJz3u9KJ5EqLr2JI5TwacUCxnmSAvWZazt9l6zdD_6CH5FGgKYQ384eDZvlY6wkSgyQjv4DLJSYZKQaVXD7vhXBbGhWFthv2SO7liWbSm7DamsXQPib1e6BN42x_ZaqYiaEEiwg40M5g)

3.  For explanation we can follow this link ( <https://techtutorialsx.com/2017/04/24/esp32-publishing-messages-to-mqtt-topic/> )

4.  The C++ code 

|

#include <WiFi.h>\
#include <PubSubClient.h>

const  char* ssid = "HUAWEI-2.4G-yzad";\
const  char* password = "SkNH972g";\
const  char* mqttServer = "broker.hivemq.com";\
const  int mqttPort = 1883;\
const  char* mqttUser = "";\
const  char* mqttPassword = "";

WiFiClient espClient;\
PubSubClient client(espClient);

void  setup() {

  Serial.begin(115200);\
  WiFi.begin(ssid, password);

 while (WiFi.status() != WL_CONNECTED) {\
    delay(500);\
    Serial.println("Connecting to WiFi..");\
  }

  Serial.println("Connected to the WiFi network");

  client.setServer(mqttServer, mqttPort);

 while (!client.connected()) {\
    Serial.println("Connecting to MQTT...");

 if (client.connect("ESP32Client", mqttUser, mqttPassword )) {

      Serial.println("connected");

} else {

      Serial.print("failed with state ");\
      Serial.print(client.state());\
      delay(2000);

    }\
  }

  client.publish("jay/sanmohadi", "Hello from ESP32");

}

void  loop() {\
  client.loop();\
}

 |

(  [link to github code](https://github.com/0SaNJ/codettesbootcamp_2023_code/blob/main/ESP_32_DHT_MQTT_link_c%2B%2B) )

1.  Then we proceed to make some changes to the code such as ![](https://lh6.googleusercontent.com/F8eb4SugJE32RZDuCT_VfCFcnDMht9KkfHeeURVpzPMstvTRCpaf2M5sj_QwI8co6Lp4rKwgsOkcgpvGFXOzZyqmc12VRFdaU5aGGYV3UxT9sMzVggmiiAuwQXG36YQ3XbnrRlflBzoMZLJiuQ6uUt8)

2.  Then we go to MQTT lens we change our host name and our port like shown![](https://lh3.googleusercontent.com/UiOWgTACD3_sxs0vhkV_RLM36-46ccGbLciI7FulJfUCUDle_Nz8z44eEiZEOLU6JsI-eaAeS0gTRlIiurgPcTiaBURHKr3EIvlbWgJ0geIg46-XUXdMs7irG7JLeA-EInZUiEKmG6Op_mmmU7vWaMw)

3.  Then you should get a message here ![](https://lh5.googleusercontent.com/EHXl8VHBJ4jlLPa5_1nDMTZNS97IMK45sDNCqSwJwfwIPnZreHhCl7gizbk7W_9-wonPYxLA5W_KKdzQIrrUSgos73pdPA0AoY_uN829nSpyyrbj3IxFysm_UyiRCEXRGnwKK-g4nSYJi22oKD0zf3g)

Week 6 
=======

Day 6 ( online )
----------------

### DHT and MQTT link:

1.  Today we are going to send our DHT data over via MQTT. First off we're are going to download the code from here and change our credentials ( Wifi SSID etc ) ( <https://docs.google.com/document/d/1gPfp3f9jbAcFxe7KjdTmtqzEG3QMySqYnl7Sw4jvW3E/edit> )

2.  The C++ code 

|

/*********\
  Rui Santos\
  Complete project details at https://randomnerdtutorials.com\
*********/

#include <WiFi.h>\
#include <ESPAsyncWebServer.h>\
#include <SPIFFS.h>\
#include <Wire.h>\
#include <Adafruit_Sensor.h>\
#include <PubSubClient.h>

#include "DHT.h"

// Replace the next variables with your SSID/Password combination\
const  char* ssid = "HUAWEI-2.4G-yzad";\
const  char* password = "SkNH972g";

// Add your MQTT Broker IP address, example:\
//const char* mqtt_server = "192.168.1.144";\
const  char* mqtt_server = "broker.hivemq.com";

WiFiClient espClient;\
PubSubClient client(espClient);\
long lastMsg = 0;\
char msg[50];\
int  value = 0;\
#define DHTPIN 4\
#define DHTTYPE DHT11\
DHT dht(DHTPIN, DHTTYPE);\
const  int ledPin = 2;\
float temperature = 0;\
float humidity = 0;\
AsyncWebServer server(80);

String readDHTTemperature() {\
 // Read temperature as Celsius (the default)\
 float t = dht.readTemperature();\
 // Convert temperature to Fahrenheit\
 //t = 1.8 * t + 32;\
 if (isnan(t)) {\
    Serial.println("Failed to read from DHT sensor!");\
 return  "";\
  }\
 else {\
    Serial.println(t);\
 return String(t);\
  }\
}\
String readDHTHumidity() {\
 float h = dht.readHumidity();\
 if (isnan(h)) {\
    Serial.println("Failed to read from DHT sensor!");\
 return  "";\
  }\
 else {\
    Serial.println(h);\
 return String(h);\
  }\
}

void  setup() {\
  Serial.begin(115200);\
 // default settings\
 // (you can also pass in a Wire library object like &Wire2)\
 //status = bme.begin();\
  setup_wifi();\
client.setServer(mqtt_server, 1883);\
  client.setCallback(callback);\
  Serial.println(F("DHTxx test!"));\
  pinMode(ledPin,OUTPUT);\
  dht.begin();\
 // Initialize SPIFFS\
 if(!SPIFFS.begin()){\
    Serial.println("An Error has occurred while mounting SPIFFS");\
 return;\
  }

}

void  setup_wifi() {\
// Connect to Wi-Fi\
  WiFi.begin(ssid, password);\
  WiFi.setSleep(false);\
 while (WiFi.status() != WL_CONNECTED) {\
    delay(1000);\
    Serial.println("Connecting to WiFi..");\
  }\
// Print ESP32 Local IP Address\
  Serial.println(WiFi.localIP());\
// Route for root / web page\
  server.on("/", HTTP_GET, [](AsyncWebServerRequest *request){\
request->send(SPIFFS, "/index.html");\
  });\
  server.on("/temperature", HTTP_GET, [](AsyncWebServerRequest   *request){\
    request->send_P(200, "text/plain", readDHTTemperature().c_str());\
  });\
  server.on("/humidity", HTTP_GET, [](AsyncWebServerRequest *request){\
    request->send_P(200, "text/plain", readDHTHumidity().c_str());\
  });\
// Start server\
  server.begin();\
}

void  callback(char* topic, byte* message, unsigned int length) {\
  Serial.print("Message arrived on topic: ");\
  Serial.print(topic);\
  Serial.print(". Message: ");\
  String messageTemp;

 for (int i = 0; i < length; i++) {\
    Serial.print((char)message[i]);\
    messageTemp += (char)message[i];\
  }\
  Serial.println();

 // Feel free to add more if statements to control more GPIOs with MQTT

 // If a message is received on the topic esp32/output, you check if the message is either "on" or "off".\
 // Changes the output state according to the message\
 if (String(topic) == "jay/sanmohadi/output") {\
    Serial.print("Changing output to ");\
 if(messageTemp == "on"){\
      Serial.println("on");\
      digitalWrite(ledPin, HIGH);\
    }\
 else  if(messageTemp == "off"){\
      Serial.println("off");\
      digitalWrite(ledPin, LOW);\
    }\
  }\
}

void  reconnect() {\
 // Loop until we're reconnected\
 while (!client.connected()) {\
    Serial.print("Attempting MQTT connection...");\
 // Attempt to connect\
 if (client.connect("ESP32Client")) {\
      Serial.println("connected");\
 // Subscribe\
      client.subscribe("jay/sanmohadi/output");\
} else {\
      Serial.print("failed, rc=");\
      Serial.print(client.state());\
      Serial.println(" try again in 5 seconds");\
 // Wait 5 seconds before retrying\
      delay(5000);\
    }\
  }\
}

void  loop() {\
 if (!client.connected()) {\
    reconnect();\
  }\
  client.loop();

 long now = millis();\
 if (now - lastMsg > 5000) {\
    lastMsg = now;

 // Temperature in Celsius\
    temperature = dht.readTemperature();\
 // Uncomment the next line to set temperature in Fahrenheit\
 // (and comment the previous temperature line)\
 //temperature = 1.8 * bme.readTemperature() + 32; // Temperature in Fahrenheit

 // Convert the value to a char array\
 char tempString[8];\
dtostrf(temperature, 1, 2, tempString);\
    Serial.print("Temperature: ");\
    Serial.println(tempString);\
    client.publish("jay/sanmohadi/reading/temperature", tempString);

    humidity = dht.readHumidity();

 // Convert the value to a char array\
 char humString[8];\
dtostrf(humidity, 1, 2, humString);\
    Serial.print("Humidity: ");\
    Serial.println(humString);\
    client.publish("jay/sanmohadi/reading/humidity", humString);\
    delay(2000);\
  }\
}

 |

1.  Then we upload the spiffs then the code and we should get a reading like shown ![](https://lh4.googleusercontent.com/VEAISNKDldAE2yq0EIto-kjk7vdKO1hmEKgzhTQTYSU7941uI1uq46wjEd2j-R1MjPJ0OzAhQsh7Q073G_lX9g3uQjuN18UmfXp7pv00tYCpkovn5mdXvO6BN446UgSGWBMfxsWDvDrGEsQ6-057_C4)

2.  For the webpage you should get something like this ![](https://lh6.googleusercontent.com/dzVWEdv0A2b5ztTuEpstf10A50459ZcSlVXv-KkA9sVE30hDOMQ9tBZG9-U2_vloxnCDTrcszz0lZ8RxR2EgaFgu12rhA7Iba9k8chp03xYTdwPyUdopRgX5NQ0op7kJ1JFaaSaGATcnjvBYk-kEChQ)As time goes on the web page will make a graph

Week 7
======

Day 7 ( online )
----------------

### Node.js setup:

1.  Today we're going to set up our node.js environment. First off we have to download node.js you can follow this tutorial on how install node.js on ubuntu ( <https://www.knowledgehut.com/blog/web-development/install-nodejs-on-ubuntu> )

2.  Then we use nvm to install node.js version 16.0.0 like here ![](https://lh4.googleusercontent.com/0gFPQ_Z9LBydVR6ii6jMR8ShLmleoSNQGiQ-WRv5oue4WvWmR0NB6MuhmaJ3o0edlxkWFCVgqRaC9PcvpZ-Y_gjN38Y__EfxTJaxNPXynswOwTS6d27NHoLpSV8W0FZH214GJdo3YiAcZ75jJBP7EiI)

3.  Then we download the code and customize it. The code can be found here ( <https://drive.google.com/drive/folders/1rq81PdjlsMFowDBo4Yq6Y9wfd-yVzd25?usp=sharing> )

4.  Now we are going to download Mosquitto. The download link can be found here ( <https://mosquitto.org/download/> )

5.  Were also going to download MongoDB Compas ( <https://www.mongodb.com/try/download/compass> )

6.  We're going to make a folder called nodejs\
    ![](https://lh3.googleusercontent.com/R3__PAxvDMBUACCHeGQoRmsS4gJX_3TUsrRwuOArurVQq2xOVdAtJEv8kxX_cGWSPJkpd5Bjq2z48hFoVsyaUQ3W_8A4qwkJD6iRMQd1vwwv2e7ohor0NcYR8Ej_hZFaal6xlwFA9mH2BVJwDv6RQx4)then we go to projects → ![](https://lh3.googleusercontent.com/m4l3fwDGzN36zEX2BcyfMdT4KA1t9U2l6FUiGtEhFsfUMpMeL53py1bTGUFFAUlYmF4pzYezZs9OnH50HI21GvCUXzDcN-PMP84U0j-_3I-VGYo-8PvQZyJVYF_wvxNV9I3B9YigKxWhHKnL456sGM0)then we make a folder called mongostack →![](https://lh6.googleusercontent.com/KZ4VEibZeSQ9eUy97bQTOy5E7GmiL_FODqZo-PWGZxOmACeBjfJ6Imbaa5OE6XjoRRp0k_z6hAo1PpYnL32ulcbikPcFv7_rxrrJEqlAvXsalWwQjYj42bLvn0SlHsDi7Axpx-w01me4IqWJjT5iHG0) and in that folder we put our app.js and public folder→ ![](https://lh3.googleusercontent.com/taElp8MQVjg4nTrGRas1dcWxf8fh4_-Ifqxh_4PCjxyLsmR2EldVdAKePwNTjEdZBZ8wa7_EaOdTrwSSNdOQH1aYPs9W-03q7nmo1YvNS7XgJ3_nuOCaQ1y2CYV-Ff5ug4kFw6bSFzd8FlfLKHtcpyA)then in that public folder we will have these files →![](https://lh3.googleusercontent.com/_7NNoFLv5CpGzaI-D81-U3s2mwT2p-gjT_0iCF_pAyVeFLAfPgBKbHnuummVTqVcn8JB7XS1hWxkfryZrR-VD59-I5etOPr_LyyCu2s1M2rb1skOZQg1v8mi5DMcoJfVA7XmzlN8I9aBPsDapPEy_zY)

7.  Now we open up the app.js file and make some changes to it\
    ![](https://lh4.googleusercontent.com/hpgTQ0CiSl_jrlqHAFpusjbMqw3hyHd6ahLhodTl4R3IRdP39KKbHdruQIobyVdcbs4PphWokWXaD6HT-PY2S63yXL2Iyb0BZStQtafsr6sC2ntgszYae7yz8ejpCKDdQ-bWhftQhS5H9jwn5ki6D9E)

8.  The .js code

|

var MongoClient = require('mongodb').MongoClient;\
var url = "mongodb://localhost:27017/";  // "mongodb://localhost:27017/iotstack";

var express = require('express');\
var app = express();

//Server Variables\
var host = process.env.IP || 'localhost';\
var port = process.env.PORT || 9000;

var staticSite = __dirname + '/public';

var mqtt = require('mqtt')

var client  = mqtt.connect([{host:'localhost',port:'1883'}]) //var client  = mqtt.connect([{host:'broker.hivemq.com',port:'1883'}]) //\
console.log("Nodejs Server Started!");

// on mqtt conect subscribe on tobic test\
client.on('connect', function () {\
  client.subscribe('jaysanmo/codettes/01', function (err) {\
console.log("sub scribing to test topic");\
      if(err)\
      console.log(err)\
  })\
})

//when recive message\
client.on('message', function (topic, message) {\
  json_check(message)\
})

//check if data json or not\
function json_check(data) {\
    try {\
      // JSON.parse(data);\
msg = JSON.parse(data.toString()); // t is JSON so handle it how u want\
    } catch (e) {\
console.log("message could not valid json " + data.toString);\
        return false;\
    }\
console.log(msg);\
var msgobj = { "msg": msg }; // message object\
    Mongo_insert(msgobj)\
console.log(msgobj);\
}

//insert data in mongodb\
function Mongo_insert(msg){\
MongoClient.connect(url, function(err, db ) {\
    if (err) throw err;\
    var dbo = db.db("cb");\
    dbo.collection("class").insertOne(msg, function(err, res) {\
      if (err) throw err;\
  console.log("data stored");\
      //db.close();\
    });\
  });\
}

// ENABLE CORS for Express (so swagger.io and external sites can use it remotely .. SECURE IT LATER!!)\
app.use(function(req, res, next) {\
  res.header("Access-Control-Allow-Origin", "*");\
  res.header("Access-Control-Allow-Headers", "Origin, X-Requested-With, Content-Type, Accept");\
  next();\
});

// ROUTES FOR OUR API\
// =============================================================================\
var router = express.Router();              // get an instance of the express Router

app.use('/', express.static(staticSite));\
// Use router for all /api requests

if (! process.env.C9_PID) {\
    console.log('Running at http://'+ host +':' + port);\
}\
app.listen(port, function() { console.log('Listening')});

 |

( [link to github code](https://github.com/0SaNJ/codettesbootcamp_2023_code/blob/main/ESP_32_DHT_MQTT_MongDb_Node.js_Mosquitto_link_app.js_code) )

1.  Then we go to our command console and go to the mongostack folder and download all the necessary files 

2.  First is express ![](https://lh3.googleusercontent.com/GRMy384UAOKqeO9UBKEZMdEY1xxW5U6PVUuOcXsOj_UVutPMOY93UaD4ztvCXRdNmYK6U5F3POvEcbd7vHeG_XMGKRD9ijhSmHvC-xhfiSPGsCx2t1XrYECc8kwJWgvAR71oTTKDXE5s2TjXPGpxzes)

3.  Then MQTT ![](https://lh6.googleusercontent.com/kDy5SS4BEVVC8B3u-X3oecAwjYwbBtCiTmXJb9gUSPI_v6ecSsLHU-f2LjL8rgDt0-0oQa-5HGcvo4Jm5xWolkYVsNhIb53tYZLnJGNLIl3YWGded274qgXBwhYZTClj-C98UiPdLGf3l12G8z789oI)

4.  Then we open a different console where we search for our ip and we check our ip on ubuntu by using this command ![](https://lh3.googleusercontent.com/WhmikaKG_yc73z3c0h1clGbj6n3oe3iVgWEPMgXqBbNFGuVv7oBqZ2hc1E2Bo_uGeaV1Lk12lf7nRBCHU92_8xJ0z8gBxd3FR5LhD48ywMzvRGP_gEZhagVyKsOgzCXccvzQRZp_VyWRE74qIAnIB3c)

5.  Then we find our ip here ![](https://lh5.googleusercontent.com/9fzJhviTXNqyCzspjc5iQ9ZXMjPDJtUB-DgsZLK08GCAxURmvgW8hl-O5tf--wnMDT2bDg9zy2p2tanLuwRPyDPZliu_n0VwRc07-Ko3S2CyXh8Ddc7DnGNqGijRXkbPU7xuYHxwc9sP38qSZixjS7A)

6.  Now we go to our mosquitto folder and put a test.conf file in there ![](https://lh3.googleusercontent.com/J9Opd2PErHcKoVLw7An81iuv2HzV1ejDQymWV-X1FBRt15LDDOP6LY3lj_fb-xFbf3SVauPUD8WB8fUN0qxBrN4xmu-wZDL_HCI2kCVMAk2uif7qxfhL8Gxk2ApN-d3rxDknduaSRt9ATkvozKxJbdw)

7.  In the test.conf we put this ![](https://lh5.googleusercontent.com/IUbsuPbAhf_iNvwqy0ngIlTqs94q3q4ItEiCMr2H2sM2flnW0tl7cAdZ8CMFsZeZSQaZJsVyb3_wSiLPX3ytlkCXjoxVRLyLqxWa4_Ab7kS64AHjkd54psIcPeGevYHmuwDsA1BtC7QhGIi5eGB0qmI)

8.  Now we open up a new terminal and path to mosquitto. Then we do\
    "mosquitto -v -c test.conf" like here ![](https://lh3.googleusercontent.com/VXjrDJSXahHbEeYKIBeuHB-sFGhS9wzdTeHBIxe8Ja0zEkdEEI48kZXHTDpnjJYaoRUzfmR99lm6uEtmB1su42NYny8aWFVg4q-G99eZ3Hpog5cPAXKXDRGmbsLRvZog85cGsazmhP4bK01yc1hDMaQ)but here there's a problem but there is a fix for that first we look on which ip the mosquitto is on by using this command ![](https://lh5.googleusercontent.com/f2AEbzbjFoMorbRPDfm3fhEme3vvSpNyEKaqXg6WIuOCyrEwZO0e59YdDSPrzQ-I9mmVaw39FPyRXt2cFSx5I3lnGjaVip2E7hMpagNaqR_lVZeT7nYemmZy5UALBM9Kq4SInL5IMoJsV4FR4f8rTsw)

9.  We kill the current running program like here ![](https://lh6.googleusercontent.com/453qyKyRouqi53PAPIPvPuTNXveoTfoXVkwTBQHhVVnMHyubaPseMJq7X0gHYpT0U0EH-HMJqm852CJ-qLSrYTV-Vo_ocopx0rxekEy2Kj3KduzrnSEe2qogu04-_dJDPHLeWAPo00FL9ZbwYwvYZiE)

10. Now the problem should be fixed as seen here ![](https://lh6.googleusercontent.com/Q9koHH9RMeZAhcaTfDc-Ps-vC9dqgj4D4mI_QGvIl0o7R-8r5uheUnN5CGpNeS-vb8wREBZi2zTA_1OwtixpMV8ZwuIrkna0bl17ksB4DrvbuimeCfYBxtq2btOfUPjWK3X-kquidSmY1CbVIFLKOvs)

11. Now we go to the mongostack folder and start our app.js file as shown here ![](https://lh3.googleusercontent.com/4ce2NRO2cOyjfbheg7bK7PiAoSliexh-dWrdIy-kptoHdf1v7QEib5SwouWly2I3DWqvg3AAaSipB7Oa3kSQ9xmMFgxaNWfVJC9sW9TR49BQpiQ653XhiOYDRHNV_OXMez_8etsCdw5dD9PypHzlQLw)

12. With all that done we upload the code and see our temps and humid in our serial monitor ![](https://lh4.googleusercontent.com/X96kOOz9TZKMbuAlOncQ3V972AVQUevUcEEyhYD0Wing3v9p63qonDAP3z0aW_k2JrmfWQS0pGbxBNjeNPxWk8p7nZm5YEH_73As-jB5Gv3cKrypNQgUnfFZ9M19UUXphm5ZB8zaleA28ByS5AUmyoM)

13. We should also see it in our mosquitto terminal like here ![](https://lh4.googleusercontent.com/aiZKP6s4UxKkjEyldZvPEc-ElBHhREQiy_4eb6Q-kEkN5uXmOf-tjtvll5RvExK5LvBQxBcD4i_NBuc5Dly_sLRU17O9uiykj5K6tRmPDz_2uNFDlzBDm-BB3gw82vxPrkhAIbI7pkMKZ_c2I7U9-A4)

14. And also in our nodejs terminal ![](https://lh6.googleusercontent.com/6EkXdZVnzJqohmfrfokYKPa8r2zo7tviWd2NAAbKk8VH8Ai9X3VNo7qE12535v3mJIQ9kaO6qCXgyWaUStbp4s-AQ6pe8jzOtl3idtaw_ibC_NiVWVy49N75LuRPgA2xmNfzgWpPGT5Qa34ofAF6XXM)

15. If we want to see the info on our MQTT lens we have to change the broker to our ip here ![](https://lh6.googleusercontent.com/Jh0pu9N00gVZX3VpFl_VZ6hfMzwNrQlLUxHx_PAPH4_m_ooTCKq13DqiylgsP6tnUH8a11Ar1Heb8ZcnUroil5IkJUWodpRqtm_p10STDjarldERGj6tOxNJXErXm76Iwgi1wEFJUolMhQW4zqgoZfU)

16. And also in our MQTT lens ![](https://lh4.googleusercontent.com/3IZMUfP-SWy7n9xD63xm4tw9dtsHdioVrK8YGy5OONhIlkFnLa2vIg8c5zkj6Vb5XVvJRZ5dbmzmayaEwNT0DQCuoc7j5-ekscWC2bltoweKyiG47uLbgoIbDWFFviUwf5Tg8N0HihudCN65IurIAec)

17. The index.html code 

|

<?xml version="1.0" encoding="UTF-8" standalone="no"?>\
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">\
<html  xmlns="http://www.w3.org/1999/xhtml">\
 <head>\
 <title>Mosquitto Websockets</title>\
 <meta  name="viewport"  content="width=device-width, initial-scale=1.0">\
 <script  src="mqttws31.js"  type="text/javascript"></script>\
 <script  src="jquery.min.js"  type="text/javascript"></script>\
 <script  src="config.js"  type="text/javascript"></script>\
 <script  src="https://code.highcharts.com/highcharts.js"></script>

 </head>\
 <body>\
 <h1>Mosquitto Websockets</h1>\
 <div  class="widget-container" >\
 <div  class="widget">\
 <i  class="fa fa-thermometer-empty"></i>\
 <span  class="label">Temp</span>\
 <span  class="widget-value temp-data">15</span>\
 </div>

 <div  class="widget">\
 <i  class="fa fa-tint"></i>\
 <span  class="label">Humid</span>\
 <span  class="widget-value humid-data">50%</span>\
 </div>\
 </div>\
 <div  id="chart-container"></div>\
 <div>\
 <div>Subscribed to <input  type='text'  id='topic'  disabled />\
Status: <input  type='text'  id='status'  size="80"  disabled /></div>

 <ul  id='ws'  style="font-family: 'Courier New', Courier, monospace;"></ul>\
 </div>\
 <script  type="text/javascript">\
 var mqtt;\
 var reconnectTimeout = 2000;

 function MQTTconnect() {\
if (typeof path == "undefined") {\
path = '/mqtt';\
}\
mqtt = new Paho.MQTT.Client(\
host,\
port,\
path,\
"web_" + parseInt(Math.random() * 100, 10)\
);\
 var options = {\
 timeout: 3,\
 useSSL: useTLS,\
 cleanSession: cleansession,\
 onSuccess: onConnect,\
 onFailure: function (message) {\
                $('#status').val("Connection failed: " + message.errorMessage + "Retrying");\
                setTimeout(MQTTconnect, reconnectTimeout);\
            }\
        };

        mqtt.onConnectionLost = onConnectionLost;\
        mqtt.onMessageArrived = onMessageArrived;

 if (username != null) {\
            options.userName = username;\
            options.password = password;\
        }\
 console.log("Host="+ host + ", port=" + port + ", path=" + path + " TLS = " + useTLS + " username=" + username + " password=" + password);\
        mqtt.connect(options);\
    }

 function onConnect() {\
        $('#status').val('Connected to ' + host + ':' + port + path);\
 // Connection succeeded; subscribe to our topic\
        mqtt.subscribe(topic, {qos: 0});\
        $('#topic').val(topic);

 // Set up chart\
        chart = Highcharts.chart('chart-container', {\
 chart: {\
 type: 'line',\
        },\
 title: {\
 text: 'Sensor Data',\
        },\
 xAxis: {\
 type: 'datetime',\
 title: {\
 text: 'Timestamp'\
          }\
        },\
 yAxis: [{\
 title: {\
 text: 'Temp'\
          }\
        }, {\
 title: {\
 text: 'Humid'\
          },\
 opposite: false  // display on opposite side of chart\
        }],\
 series: [{\
 name: 'Temp',\
 data: [],\
 yAxis: 0  // use the first yAxis (index 0) for this series\
        }, {\
 name: 'Humid',\
 data: [],\
 yAxis: 1  // use the second yAxis (index 1) for this series\
        }]\
      });\
    }

 function onConnectionLost(response) {\
        setTimeout(MQTTconnect, reconnectTimeout);\
        $('#status').val("connection lost: " + responseObject.errorMessage + ". Reconnecting");

    };

 function onMessageArrived(message) {

 var topic = message.destinationName;\
 var payload = message.payloadString;

        $('#ws').prepend('<li>' + topic + ' = ' + payload + '</li>');

 // Parse message data\
 var data = JSON.parse(payload);\
 var timestamp = new  Date().getTime();\
 var temp = parseFloat(data.temp);\
 var humid = parseFloat(data.humid);

        chart.series[0].addPoint([Date.now(), data.temp]);\
        chart.series[1].addPoint([Date.now(), data.humid]);\
 // Redraw the chart\
        chart.redraw();

 //WIDGET\
 const widgetContainers = document.querySelectorAll('.widget-container');

 // Loop through each widget container and update the widget data\
        widgetContainers.forEach(widgetElement => {\
          widgetElement.querySelector('.temp-data').textContent = data.temp;\
          widgetElement.querySelector('.humid-data').textContent = data.humid;\
        });\
    };

    $(document).ready(function() {\
        MQTTconnect();\
    });

 </script>\
 </body>\
</html>

<style>\
 .widget-container {\
 display: flex;\
 flex-wrap: wrap;\
 justify-content: space-between;\
 width: 100%;\
 max-width: 1200px;\
 margin: 0 auto;\
    }

 .widget {\
 flex-basis: calc((100% - 30px) / 4); /* 4 widgets in the first row */\
 margin-bottom: 20px;\
 background-color: #ffffff;\
 padding: 10px;\
 border: 1px solid #e3e3e3;\
 text-align: center;\
    }\
</style>

 |

( [link to github code](https://github.com/0SaNJ/codettesbootcamp_2023_code/blob/main/ESP_32_DHT_MQTT_MongoDB_Node.js_Mosquitto_html_code)  )

1.  The C++ code 

|

// Import required libraries\
#include <WiFi.h>\
#include <ESPAsyncWebServer.h>\
#include <SPIFFS.h>\
#include <Wire.h>\
#include <Adafruit_Sensor.h>\
#include <DHT.h>

//MQTT\
#include<PubSubClient.h>\
#include <ArduinoJson.h>

WiFiClient espClient;\
PubSubClient client(espClient);

//MQTT\
const  char * mqtt_broker = "192.168.1.69";\
//const char * mqtt_broker = "broker.hivemq.com";\
const  char * mqtt_topic = "jaysanmo/codettes/01"; // CHANGE SensorID here!\
const  char * mqtt_User = "";\
const  char * mqtt_Password = "";

// Replace with your network credentials\
const  char* ssid = "Team09";\
const  char* password = "H@ckTe@m)(";

#define DHTPIN 4\
#define DHTTYPE    DHT11\
DHT dht(DHTPIN, DHTTYPE);\
// Create AsyncWebServer object on port 80\
AsyncWebServer server(80);

float t = 0;\
float h = 0;

String readDHTTemperature() {\
 // Read temperature as Celsius (the default)\
 float t = dht.readTemperature();\
 // Convert temperature to Fahrenheit\
 //t = 1.8 * t + 32;\
 if (isnan(t)) {\
    Serial.println("Failed to read from DHT sensor!");\
 return  "";\
  }\
 else {\
    Serial.println(t);\
 return String(t);\
  }\
}\
String readDHTHumidity() {\
 float h = dht.readHumidity();\
 if (isnan(h)) {\
    Serial.println("Failed to read from DHT sensor!");\
 return  "";\
  }\
 else {\
    Serial.println(h);\
 return String(h);\
  }\
}\
void  setup() {\
 // Serial port for debugging purposes\
  Serial.begin(115200);\
  dht.begin();\
 // Initialize SPIFFS\
 if (!SPIFFS.begin()) {\
    Serial.println("An Error has occurred while mounting SPIFFS");\
 return;\
  }\
 // Connect to Wi-Fi\
  WiFi.begin(ssid, password);\
  WiFi.setSleep(false);\
 while (WiFi.status() != WL_CONNECTED) {\
    delay(1000);\
    Serial.println("Connecting to WiFi..");\
  }\
 // Print ESP32 Local IP Address\
  Serial.println(WiFi.localIP());

 //MQTT\
client.setServer(mqtt_broker, 1883);\
 if (initMqtt()) {\
    client.publish("jaysanmo/codettes/01", "Hello from ESP32");\
  }

 // Route for root / web page\
  server.on("/", HTTP_GET, [](AsyncWebServerRequest * request) {\
request->send(SPIFFS, "/index.html");\
  });\
  server.on("/temperature", HTTP_GET, [](AsyncWebServerRequest   * request) {\
    request->send_P(200, "text/plain", readDHTTemperature().c_str());\
  });\
  server.on("/humidity", HTTP_GET, [](AsyncWebServerRequest * request) {\
    request->send_P(200, "text/plain", readDHTHumidity().c_str());\
  });\
 // Start server\
  server.begin();\
}

unsigned long lastMqttTime = millis();\
const unsigned long Mqtt_INTERVAL_MS = 2000;\
void  loop() {

  client.loop();

 // Send regular mqtt data\
 if ((millis() - lastMqttTime) > Mqtt_INTERVAL_MS) {\
 if (client.connected())\
    {\
 //GetWeatherData();\
      handle_MqttData();\
      lastMqttTime = millis();\
} else\
    {\
      initMqtt();\
    }

  }\
}\
void  GetWeatherData()\
{

}

bool  initMqtt()\
{\
 if (!client.connected()) {\
    Serial.println("Connecting to MQTT...");

 if (client.connect("ESP32Client", mqtt_User, mqtt_Password )) {

      Serial.println("connected");\
 return  true;

} else {

      Serial.print("failed with state ");\
      Serial.print(client.state());\
      delay(2000);\
 return  false;\
    }\
  }\
}

void  handle_MqttData() {\
 float h = dht.readHumidity();\
 float t = dht.readTemperature();

  StaticJsonDocument<2048> doc;\
 //JsonObject createNestedObject() const;

  doc["temp"] = t;\
  doc["humid"] = h;

 char  out[2048];\
 int b = serializeJson(doc, out);\
  serializeJson(doc, Serial);\
  Serial.print("bytes ->  ");\
  Serial.print(b, DEC);\
 // add if delivered or not\
  client.publish((char*)mqtt_topic, out) ? Serial.println(" -> delivered") : Serial.println(" -> failed");\
}

 |

( [link to github code](https://github.com/0SaNJ/codettesbootcamp_2023_code/blob/main/ESP_32_DHT_MQTT_Node.js_MongoDB_Mosquitto_link_c%2B%2B_code) )

Week 8
======

Day 8 ( online )
----------------

### MongoDB connection: 

1.  All the steps from last week 

2.  Connect to mongoDB Compass as seen here and you should see this\
    ![](https://lh6.googleusercontent.com/7mEDoyYBUmBGEcp62KQKeY4cbTSwLgBnw6mzm6S7MhnmCkJ18MDaYyOSpf6UZ7zPDp63hkrLCxH6-ejUeXJhgroYAngceLHbM2b3rrOiEufJrBCOQSssaoeE47iDC0UlNrLLQHZSzsrhgPs5OB_hyiU)

Week 9
======

Day 9 ( online )
----------------

### Live Highcharts:

1.  Same steps as the last 2 weeks

2.  Now we go into our index.html ( download index.html here <https://drive.google.com/file/d/1kJpv-vVDiMtk_jqT-kp-OBGmptDSfbx5/view?usp=drive_link> ) file in our mongostack folder then we put the highcharts in ( <https://www.highcharts.com/> ) ![](https://lh3.googleusercontent.com/xYr8kRtoyC0IopYr5FhBpeKt8yKdJSoGVfwJrLtoeOtyGO0ygjcz_UHlFYZdlU5k-wBBjI0TctE6Y_6yGVeiwp8Imbfa2AzTnxS8QjaH6cYJiq6I8A4UzCXRmyuDzNdSJWM9rTobStfFWO1nMhDwF-Q) →![](https://lh3.googleusercontent.com/MFG8R7WcLbnHe1pfWPNbij02UoCfQ2vID_U_uvmyyi23wtuxCllP_PUxUoCeMpwoIHvupQ7XjH0CiOGJxAmGYsBt_QlgI9fR4_55qipueEi44VdCwaWXyVvaKcDj8Ec5Ce_4j_q4GNcttiXGnhdB11g)→ ![](https://lh5.googleusercontent.com/kFRbuX_gSpqt78IwF0npGRhyzkq9omZ9KIj7w05othhJoF_Qpi84vYImMcwHIJ78Sktamqz3QUmsMDOOjs_WPfxHEHaVA4i20dlE1hj66Xxya7kDtOVVaYV3V2jCcDOU-pNdKXf6xoXXFDAIe_P0bQw)

3.  Your chart should look something like this ![](https://lh6.googleusercontent.com/70hQ2wH3H7t7G2X--HZakn_3vkAQsOKvFxsSHFIXMKiXMqFviBjUnL8pVrnlElLBOyGQvVXBH6Jggg-T72flakjyIEmXLGITbLvm8DjasIfFtGYZCmcg9xha2Yhzi4zZ9tlpSVQvpEe_LiqqrjHC_wM) 

Week 10 
========

Day 10 ( online )
-----------------

### Customizing our highcharts:

1.  First we do the same things as last week and open our index.html 

2.  Then we customize it 

3.  First we add our icons as shown here\
    ![](https://lh6.googleusercontent.com/z8GtpnTTOJPttdih4LegtW1F5e8udZvaBh4IxLSBmeBfDIkbRU6IxU_8ftV2-F_ZzDWUThJhZrVJEtkF5OLafeoedbAI_sAURgtEbLWaNcR5ZU7I74VFdHbIYfVqNFHgceaysLI_HIQS-MAgfgGGJ54)

4.  Then to update the info the charts we do this\
    ![](https://lh3.googleusercontent.com/GHDZJtwNppfuUy8kALSXqxnO8BWg2CB3gn3FlqsPJmL7jEYOifp0EuQ9ZVVz8937W7FEX7aQHhAFNYYVxya7dbZD3aECbF6Dw12j3TCAJak4Qh99RVkvpqkwAXJm64HE9Gj7CeSJgBnjvbqhNXG0dpA)

5.  Then we style it to our liking here\
    ![](https://lh6.googleusercontent.com/NeDnDUrwl-Ezy68Pug1rjo9WNuQKLzN8ZdEIokIo05ZFQ46fCH6bGPk3WAqtfrr0PlGBwv6R5UvWOnkDKQLQaZl2kScPTttORBeWB_qwSKq0OG1Ue60n79s6LnaC2j7NrWW7_T5IuNTmTYbmNHyt2ig)

6.  It should look something like this ![](https://lh5.googleusercontent.com/SLG9zdOIpQAo8LgzCOofJup8Wryi8mvZlBnetu7dNTxI7_wD5Ysl-vQXrYtaXYm8rEYiWHzSXCpP_5wU5ypcqRIYrrM_q_rRS5mpcnJnvVGHvLCFQ8ZqudGUsNQHJxJnTLJuSCSAcaY_n4Zp1t4c0w8)